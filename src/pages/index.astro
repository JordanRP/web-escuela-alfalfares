---
import Layout from '../layouts/Layout.astro';
import ImageLink from '../components/ImageLink.astro';
import { getCollection } from 'astro:content';
import CardNoticia from '../components/CardNoticia.astro';
import Slider from '../components/Slider.astro';
const todosLosPosts = await getCollection('blog');

const postsProcesados = todosLosPosts.map(post => {

  const fechaPublicacion = post.data.pubDate ? new Date(post.data.pubDate) : null;

  if (fechaPublicacion && isNaN(fechaPublicacion.getTime())) {
      console.warn(`Fecha inválida para el post "${post.data.title}": ${post.data.pubDate}`);
      return { ...post , Image, };
  }

  return {
    ...post,
    data: {
      ...post.data,
      pubDateObj: fechaPublicacion, // Guardamos el objeto Date
    }
  };
}).filter(post => post.data.title && post.data.pubDate);

const postsOrdenados = postsProcesados.sort((a, b) => {
  return b.data.pubDate.getTime() - a.data.pubDate.getTime();
});

const postsRecientes = postsOrdenados.slice(0, 3); // Muestra los 3 más recientes

// prueba post
---

<Layout title="Escuela de Colonia Alfalfares" >
	<Slider slot="header">
	</Slider>
	<div class="main-div-index">
		<section id="noticias-blog-local">
			<div style="text-align: justify;">
				<h2>Últimas Noticias</h2>
				<hr>
			</div>
			{postsRecientes.length > 0 ? (
			  <div class="noticias-grid" >
				{postsRecientes.map(post => (
				  <CardNoticia
					title={post.data.title}
					date={post.data.pubDate}
					slug={post.id}
					imageUrl={post.data.heroImage}
				  />
				))}
			  </div>
			) : (
			  <p>No hay noticias disponibles en este momento.</p>
			)}
		</section>

		<section>
			<div style="text-align:justify;">
				<h2>Que es la Educación para Nosotros</h2></div><hr>
			<div class="size-p" >
				<div class="slider-div">
					<div class="roll-images-banner">
						<img src="/colegio-actividades-1.jpg" alt="escuela alfalfares">
						<img src="/colegio-actividades-6.jpg" alt="escuela alfalfares">
						<img src="/colegio-actividades-12.jpg" alt="escuela alfalfares">
					</div>
				</div>
				<p>
					El aprendizaje y desarrollo integral de los niños y niñas de la Escuela de Colonia
					Alfalfares es un constante trabajo de enseñanza –aprendizaje que el establecimiento
					educacional realiza junto a las familias y la comunidad, como parte del proceso de
					mejora continua para lograr potenciar al máximo las capacidades de los educados y
					garantizar el derecho inherente a todo niño y niña a una educación de calidad.
				</p>
			</div>
		</section>

		<div style="" class="slider-div">
			<h3>Reseña Histórica: Conoce nuestro establecimiento</h3><hr>
			<div class="slider">
				<img src="/colegio-1.webp" class="" alt="Imagen Escuela de Colonia Alfalfares | escuela alfalfares 1">
				<img src="/colegio-2.webp" class="" alt="Imagen Escuela de Colonia Alfalfares | escuela alfalfares 2">
				<img src="/colegio-3.webp" class="" alt="Imagen Escuela de Colonia Alfalfares | escuela alfalfares 3">
				<img src="/colegio-4.webp" class="" alt="Imagen Escuela de Colonia Alfalfares | escuela alfalfares 4">
				<img src="/colegio-5.webp" class="" alt="Imagen Escuela de Colonia Alfalfares | escuela alfalfares 5">
			</div>
			<div class="size-p"><hr>
				<p style="text-align: justify; column-count:2;">
					Escuela de Colonia Alfalfares fue creada en Mayo de 1965, en un terreno
					asignado por la repartición de la Reforma Agraria en el sector, siendo entonces una
					pequeña infraestructura de material ligero. <br>
					Desde sus inicios, se impartía educación de 1° a 6° año básico; ya en 1986 se
					creó el 7° año básico, en 1987 el 8° año básico y en la actualidad se imparte educación
					desde Pre kínder a Octavo Año Básico, con un sistema educativo inclusivo, con un
					curso por nivel y la educación parvularia es impartida en curso combinado. <br>
					Se cuenta con el recurso humano para atender a los alumnos, tales como:
					Programa de Integración Escolar con recursos PIE, Biblioteca CRA y Recursos
					financieros provenientes de la Subvención de Mantenimiento y Ley SEP. Lo cual
					garantiza un proceso educativo y alienta a mantener altas expectativas en los avances
					de los alumnos, para que sumen y cumplan sus aspiraciones de ser promovidos, y en
					los casos de los alumnos de 8° año básico, ingresar a la Enseñanza Media y Superior.
					En el 2008, se construyó el moderno edificio de 3 pisos que en la actualidad
					cobija a toda la comunidad Alfalfarina y el que ha sido receptor de la Certificación de
					ser un colegio Preventivo, entonces desde el 2011 el colegio participa del Proyecto de
					Prevención del consumo de Drogas y Alcohol de SENDA en conjunto con las
					organizaciones comunitarias del sector de Alfalfares. 
				</p>
			</div>
		</div>

	</div>
</Layout>


